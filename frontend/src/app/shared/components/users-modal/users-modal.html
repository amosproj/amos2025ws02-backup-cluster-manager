<!-- add-users-modal.html -->
<div
  *ngIf="open"
  class="fixed inset-0 z-50 flex justify-center items-center overflow-y-auto bg-opacity-40"
  tabindex="-1"
  aria-modal="true"
  role="dialog"
>
  <div class="relative p-4 w-full max-w-md">
    <div class="bg-neutral-primary-soft border border-default rounded-base shadow-sm p-4 md:p-6">
      <!-- Modal Header -->
      <div class="flex items-center justify-between border-b border-default pb-4">
        <h3 class="text-lg font-medium text-heading">
          {{ mode === 'create' ? 'Add User' : mode === 'edit' ? 'Edit User' : 'Delete User' }}
        </h3>
        <button
          (click)="close()"
          class="w-9 h-9 flex justify-center items-center"
          aria-label="Close"
        >
          <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none">
            <path
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18 17.94 6M18 18 6.06 6"
            />
          </svg>
        </button>
      </div>

      <!-- Delete Confirmation -->
      <form *ngIf="mode === 'delete'" (ngSubmit)="onSubmit()">
        <div class="grid gap-4 py-4">
          <label class="block mb-2 text-sm font-medium text-heading">Name</label>
          <input
            type="text"
            [(ngModel)]="formData.name"
            name="name"
            class="w-full bg-neutral-secondary-medium border border-default-medium rounded-base px-3 py-2.5"
            placeholder="Username"
            required
          />
        </div>
        <p class="text-sm text-body mb-4">
          Are you sure you want to delete user
          <span class="font-semibold text-heading">{{ user?.name }}</span>?
        </p>
        <div class="flex justify-end space-x-3">
          <button
            type="button"
            class="px-4 py-2 text-sm bg-red-600 text-white rounded-base"
            (click)="onSubmit()"
          >
            Delete
          </button>
            <button
              type="button"
              (click)="close()"
              class="px-4 py-2 text-sm bg-neutral-secondary-medium rounded-base"
            >
              Cancel
            </button>
        </div>
      </form>

      <!-- Create Form -->
      <form *ngIf="mode === 'create'" (ngSubmit)="onSubmit()">
        <div class="grid gap-4 py-4">
          <div>
            <label class="block mb-2 text-sm font-medium text-heading">Name</label>
            <input
              type="text"
              [(ngModel)]="formData.name"
              (input)="onNameInput($event.target.value)"
              name="name"
              autocomplete="off"
              class="w-full bg-neutral-secondary-medium border border-default-medium rounded-base px-3 py-2.5"
              placeholder="Username"
              required
            />
            <ul *ngIf="suggestions.length" class="mt-1 border border-default-medium rounded-base bg-neutral-secondary-medium max-h-40 overflow-auto text-sm">
              <li *ngFor="let s of suggestions" (click)="pickSuggestion(s)" class="px-3 py-1 cursor-pointer hover:bg-neutral-primary-soft">{{ s }}</li>
            </ul>
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-heading">Password</label>
            <input
              type="password"
              [(ngModel)]="formData.password"
              name="password"
              class="w-full bg-neutral-secondary-medium border border-default-medium rounded-base px-3 py-2.5"
              placeholder="Password"
              required
            />
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-heading">Status</label>
            <div class="flex gap-6">  
              <label class="flex items-center gap-2 text-sm">
                <input type="radio" [(ngModel)]="formData.status" name="status" value="disabled" />
                Disabled
              </label>
              <label class="flex items-center gap-2 text-sm">
                <input type="radio" [(ngModel)]="formData.status" name="status" value="enabled" />
                Enabled
              </label>
            </div>
          </div>
          <div class="col-span-2 sm:col-span-1">
            <label for="category" class="block mb-2.5 text-sm font-medium text-heading">Select Group</label>
            <select id="category" class="block w-full px-3 py-2.5 bg-neutral-secondary-medium border border-default-medium text-heading text-sm rounded-base focus:ring-brand focus:border-brand shadow-xs placeholder:text-body" [(ngModel)]="formData.role" name="role" required>
              <option *ngFor="let g of groups" [ngValue]="g.id">{{ g.name }}</option>
            </select>
          </div>
        </div>
        <div class="flex items-center space-x-4 border-t border-default pt-4">
          <button type="submit" class="px-4 py-2.5 bg-brand text-white rounded-base">Add User</button>
          <button type="button" (click)="close()" class="px-4 py-2.5 bg-neutral-secondary-medium rounded-base">Cancel</button>
        </div>
      </form>

      <!-- Edit Form -->
      <form *ngIf="mode === 'edit'" (ngSubmit)="onSubmit()">
        <div class="grid gap-4 py-4">
          <div>
            <label class="block mb-2 text-sm font-medium text-heading">Name</label>
            <input
              type="text"
              [(ngModel)]="formData.name"
              (input)="onNameInput($event.target.value)"
              name="name"
              autocomplete="off"
              class="w-full bg-neutral-secondary-medium border border-default-medium rounded-base px-3 py-2.5"
              placeholder="Username"
              required
            />
            <ul *ngIf="suggestions.length" class="mt-1 border border-default-medium rounded-base bg-neutral-secondary-medium max-h-40 overflow-auto text-sm">
              <li *ngFor="let s of suggestions" (click)="pickSuggestion(s)" class="px-3 py-1 cursor-pointer hover:bg-neutral-primary-soft">{{ s }}</li>
            </ul>
          </div>
          <div>
            <label class="block mb-2 text-sm font-medium text-heading">Status</label>
            <div class="flex gap-6">  
              <label class="flex items-center gap-2 text-sm">
                <input type="radio" [(ngModel)]="formData.status" name="status" [value]="false" />
                Disabled
              </label>
              <label class="flex items-center gap-2 text-sm">
                <input type="radio" [(ngModel)]="formData.status" name="status" [value]="true" />
                Enabled
              </label>
            </div>
          </div>
          <div class="col-span-2 sm:col-span-1">
            <label for="category" class="block mb-2.5 text-sm font-medium text-heading">Select Group</label>
            <select id="category" class="block w-full px-3 py-2.5 bg-neutral-secondary-medium border border-default-medium text-heading text-sm rounded-base focus:ring-brand focus:border-brand shadow-xs placeholder:text-body" [(ngModel)]="formData.role" name="role" required>
              <option *ngFor="let g of groups" [ngValue]="g.id">{{ g.name }}</option>
            </select>
          </div>
        </div>
        <div class="flex items-center space-x-4 border-t border-default pt-4">
          <button type="submit" class="px-4 py-2.5 bg-brand text-white rounded-base">Edit User</button>
          <button type="button" (click)="close()" class="px-4 py-2.5 bg-neutral-secondary-medium rounded-base">Cancel</button>
        </div>
      </form>
    </div>
  </div>
</div>
